

<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
  <meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Registrieren</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.0.8/js/all.js"></script>
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link href="../css/style.css" rel="stylesheet"> <!-- Prioritaet vor BT-->
  <link href="../css/bootstrap.css" rel="stylesheet">

  
    <!-- Bootstrap core JavaScript -->
    <script src="../vendor/jquery/jquery.min.js"></script>
    <script src="../vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  
    <!-- Plugin JavaScript -->
    <script src="../vendor/jquery-easing/jquery.easing.min.js"></script>
    <script src="../http://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
    //jquery einbinden
    </script>

    <style>
        .errorDescr{
            color: red;
            display: none;
        }

        td {
        text-align: center;
        vertical-align: middle;
      }
    </style>

  </head>



  <body>

          <!-- Navigation -->

          <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top" id="mainNav">
    <div class="container">
      <ol class="navbar-nav mx-auto"> <!-- Ausrichtung angeben [mx-auto steht für Margin x für Center (r left und l right)] -->
        <li class="nav-item">
            <a class="navbar-brand js-scroll-trigger " href="../php/Druck3DShop.php">Druck 3D Shop</a>
              <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
              </button>
        </li>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ol class="navbar-nav">
           <li class="nav-item search-bar">
            <form>
              <div class="input-group">
                  <input type="text" class="form-control mr-sm-2" placeholder="Search" name="search">
                  <div class="input-group-btn">
                    <button class="btn btn-default" type="submit">
                      <i class="fa fa-search"></i></button>
                  </div>
              </div>
            </form>
          </li> 
          <li class="nav-item">
            <a class="nav-link" style="white-space: nowrap;" href="../php/about.php">&Uumlber uns</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" style="white-space: nowrap;" href="../php/contact.php">Kontakt</a>
          </li>
        </ol>
      </div>
    </div>
  </nav> 


  <header>
    <div class="text-center">
      <div>
        <div class="card bg-dark text-white" style="width: 101%;">
          <img class="card-img-banner" style="opacity: 0.2; height:200px;" src="../img/background/IT_Background.jpg" alt="Card image">
          <div class="card-img-overlay">
            <div class="container">
              <img src="../img/background/Druck3D_3.JPG" width="58%" style="border-radius: 30px;" >
          </div>
          </div>
        </div>
      </div>
    </div>
  </header>


  
  <div class="text-center">
    <div class="card text-black">
      <img class="card-img-banner" style="opacity: 0.7; height:800px" src="../img/background/White_Login_BG.png" alt="Card image">
      <div class="card-img-overlay">
          <div class="wrapper fadeInDown">
              <div id="formContent">
                <!-- Tabs Titles -->
            
                <!-- Icon -->
                <div class="fadeIn first">
                  <img src="../img/background/Icon_Benutzer.png" id="icon" alt="User Icon" />
                </div>
            
                <!-- Login Form -->
                <form action="../php/newUserSubmit.php" method="POST" id="myForm">
                <table  style="margin:0 auto;">
                  <tr>
                    <th style="text-align:center;">Benutzername</th>
                    <th style="text-align:center; flex-wrap: nowrap;"><label for="username"></label><input type="text" name="username" id="username" placeholder="Username" title="Benutzername"><div class="errorDescr" id="usernameError">Bitte kein ' eingeben.</div><div class="errorDescr" id="missingUsername">Bitte geben Sie einen Namen an.</div><div class="errorDescr" id="usernameExisting">Dieser Benutzername ist bereits vergeben.</div><br></th>
                  </tr>
                  <tr>
                    <th style="text-align:center">E-Mail</th>
                    <th style="text-align:center; flex-wrap: nowrap;"><label for="email"></label><input type="text" name="email" id="email" placeholder="email@example.com" title="E-Mail"><div class="errorDescr" id="emailError">Bitte geben Sie eine gültige E-Mail Adresse an.</div><br></th>
                  </tr>
                  <tr>
                    <th style="text-align:center">Passwort</th>
                    <th style="text-align:center; flex-wrap: nowrap;"><label for="password"></label><input type="password" name="password" id="password" placeholder="Passwort eingeben" title="Passwort"><div class="errorDescr" id="passwordError">Bitte kein ' eingeben.</div><div class="errorDescr" id="missingPassword">Bitte geben Sie ein Passwort ein.</div><br></th>
                  </tr>
                  <tr>
                    <th style="text-align:center">Best&auml;tigung</th>
                    <th style="text-align:center; flex-wrap: nowrap;"><label for="valpassword"></label><input type="password" name="valpassword" id="valpassword" placeholder="Passwort bestätigen"><div class="errorDescr" id="passwordSame">Passwörter stimmen nicht überein</div><br></th>
                  </tr>
                </table>
                <input type="button" id="loginform" value="Jetzt Registrieren" onclick="validate()">
              </form>
              </div>
            </div>
          </div>
        </div>
      </div>
</div>

 
<script>
    function submitForm()
    {
        document.getElementById("myForm").submit();
    }

    function resetUI()
    {
        var errorDescrs = document.getElementsByClassName("errorDescr");
        for(var i = 0;i<errorDescrs.length;i++)
        {
            errorDescrs[i].style.display = "none";
        }
    }

    function checkPW()
    {
        const password = document.getElementById("password").value;
        const valpassword = document.getElementById("valpassword").value;

        if(password!=valpassword)
        {
            document.getElementById("password").value = "";
            document.getElementById("valpassword").value = "";
            document.getElementById("passwordSame").style.display = "block";
            return true;
        }
        return false;
    }

    function checkallinput()
    {
        const REGEX = /^[^']*$/;
        const EMAILREGEX = /^[^']+@[^']+\.[^']+$/;
        var error = false;

        const username = document.getElementById("username").value;
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;

        if(username=="")
        {
            document.getElementById("missingUsername").style.display = "block";
            error = true;
        }
        else if(!REGEX.test(username))
        {
            document.getElementById("usernameError").style.display = "block";
            error = true;
        }
        
        if(!EMAILREGEX.test(email))
        {
            document.getElementById("emailError").style.display = "block";
            error = true;
        }
        
        if(password=="")
        {
            document.getElementById("missingPassword").style.display = "block";
            error = true;
        }
        if(!REGEX.test(password))
        {
            document.getElementById("passwordError").style.display = "block";
            error = true;
        }
        
        return error;
    }

    const validate = () => {
        const username = document.getElementById("username").value;
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;
        const valpassword = document.getElementById("valpassword").value;

        resetUI();

        var error_existing = false;
        type_error = checkallinput();
        pw_false = checkPW();
        
        error_existing = pw_false || type_error;

        if(error_existing)
        {
            return;
        }
        var a = $.ajax({
            type: "POST",
            url: "../php/validateUser.php",
            data: {
                username: username
            },
            async: true
        }).done(function(data){
            if(data==0)
            {
                submitForm();
            }
            else if(data == 1)
            {
                document.getElementById("usernameExisting").style.display = "block";
            }
            else
            {
                alert("Die Kommunikation zwischen validateUser.php und hier stimmt nicht.");
            }
        })
        
    }
</script>


  
  <footer class="page-footer font-small indigo">

<!-- Footer Links -->
<div class="container text-center text-md-left">

  <!-- Grid row -->
  <div class="row">

    <!-- Grid column -->
    <div class="col-md-3 mx-auto">

      <!-- Links -->
      <h5 class="font-weight-bold text-uppercase mt-3 mb-4">&Uuml;ber Druck3DShop</h5>

      <ul class="list-unstyled">
        <li>
          <a href="../php/contact.php">Kontakt</a>
        </li>
        <li>
          <a href="../php/default.php">Karriere bei Druck3DShop</a>
        </li>
        <li>
          <a href="../php/default.php">&Uuml;ber uns</a>
        </li>
        <li>
          <a href="../php/default.php">Nachhaltigkeit</a>
        </li>
      </ul>

    </div>
    <!-- Grid column -->

    <hr class="clearfix w-100 d-md-none">

    <!-- Grid column -->
    <div class="col-md-3 mx-auto">

      <!-- Links -->
      <h5 class="font-weight-bold text-uppercase mt-3 mb-4">Geld verdienen mit 3D-Druck</h5>

      <ul class="list-unstyled">
        <li>
          <a href="../php/default.php">jetzt verkaufen</a>
        </li>
        <li>
          <a href="../php/default.php">Versand durch Druck3DShop</a>
        </li>
      </ul>

    </div>
    <!-- Grid column -->

    <hr class="clearfix w-100 d-md-none">

    <!-- Grid column -->
    <div class="col-md-3 mx-auto">

      <!-- Links -->
      <h5 class="font-weight-bold text-uppercase mt-3 mb-4">Zahlungsarten</h5>

      <ul class="list-unstyled">
        <li>
          <a href="../php/default.php">Druck3D Visa Karte</a>
        </li>
        <li>
          <a href="../php/default.php">Gutscheine</a>
        </li>
        <li>
          <a href="../php/default.php">Bankeinzug</a>
        </li>
      </ul>

    </div>

    <!-- Grid column -->

  </div>
  <!-- Grid row -->

</div>
<!-- Footer Links -->

<!-- Copyright -->
<div class="footer-copyright text-center py-3">© 2020 Copyright:
  <a href="../php/default.php"> Druck3DShop</a>
</div>
<!-- Copyright -->

</footer>
<!-- Footer -->

  </body>
</html>

